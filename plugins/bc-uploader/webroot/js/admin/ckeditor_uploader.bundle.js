(()=>{function t(t){return ret=t.match(/.*?\.([a-zA-Z0-9]*?)$/),!!ret&&(ext=ret[1],"png"==ext||"gif"==ext||"jpg"==ext)}function e(e,i){var n,a,l;return(n=e.match(/\/([^\/]*?)\.([a-zA-Z0-9]*?)$/))?(a=decodeURI(n[1].replace(/__[a-z]*?$/,"")),l=n[2],i&&t(e)?a+"__"+i+"."+l:a+"."+l):e}function i(t,i){var n,a;return a=e(t,i),(n=t.match(/^(.*\/)([^\/]*?)\.([a-zA-Z0-9]*?)$/))?n[1]+a:t}
/**
 * baserCMS :  Based Website Development Project <https://basercms.net>
 * Copyright (c) NPO baser foundation <https://baserfoundation.org/>
 *
 * @copyright     Copyright (c) NPO baser foundation
 * @link          https://basercms.net baserCMS Project
 * @since         5.0.0
 * @license       https://basercms.net/license/index.html MIT License
 */
CKEDITOR.dialog.exists("Image")||CKEDITOR.dialog.add("baserUploaderDialog",(function(n){return{title:bcI18n.ckeditorTitle,minWidth:1e3,minHeight:510,whiteSpace:"normal",onShow:function(){this.editMode=!1;var t=this.getParentEditor().getSelection().getSelectedElement(),e=this.getParentEditor().getSelection(),i=e.getRanges(),n=!1,a=$("#"+this.getContentElement("info","formElements2").domId).show();if(t&&"img"==t.getName())this.editMode=!0,n=!0;else if(1==i.length){(t=i[0].getCommonAncestor(!0).getAscendant("a",!0))&&t.getAttribute("href")&&(e.selectElement(t),a.hide())}this.setupContent(t,n)},onOk:function(){var e,a,l=this.getContentElement("info","txtUrl").getValue();if(!l)return alert(bcI18n.ckeditorAlertMessage1),!1;if(t(l)?((e=n.document.createElement("img")).setAttribute("alt",""),a=!0):((e=n.document.createElement("a")).setAttribute("title",""),e.setAttribute("class","file-link"),e.setAttribute("target","_blank"),a=!1),this.commitContent(e,a),a){var o=$("#"+this.getContentElement("info","rdoSize").domId);if(!this.editMode){var r="";this.getValueOf("info","rdoSize")&&(o.find("input[type=radio]").eq(3).prop("disabled")?o.find("input[type=radio]").eq(2).prop("disabled")?o.find("input[type=radio]").eq(1).prop("disabled")||(r="small"):r="midium":r="large");var d=i(e.getAttribute("src"),r),s=n.document.createElement("a");if(s.setAttribute("href",d),s.setAttribute("rel","colorbox"),s.setAttribute("title",e.getAttribute("alt")),s.append(e,!1),this.getContentElement("info","chkCaption").getValue()){var c,p=$.parseJSON($("#UploaderImageSettings").html());this.getValueOf("info","rdoSize")&&(c=p[this.getValueOf("info","rdoSize")].width);var u=n.document.createElement("div"),m=n.document.createElement("div");u.setAttribute("class","bc-caption"),c&&u.setAttribute("style","width:"+c+"px"),m.setAttribute("class","bc-caption-text"),m.appendHtml(this.getContentElement("info","txtAlt").getValue()),u.append(s),u.append(m),s=u}e=s}}return n.insertElement(e),$("#EditDialog").remove(),!0},onCancel:function(){$("#EditDialog").remove()},contents:[{id:"info",label:bcI18n.ckeditorInfoLabel,title:bcI18n.ckeditorInfoTitle,elements:[{id:"formElements1",type:"hbox",padding:0,widths:["45%","45%","10%"],children:[{id:"txtUrl",type:"text",label:"URL",style:"margin-right : 10px;",setup:function(e,i){e&&(i?this.setValue(decodeURI(e.getAttribute("src"))):this.setValue(decodeURI(e.getAttribute("href"))));var n=$("#"+this.domId).find("input"),a=this.getDialog();n.bind("keyup",(function(){var e=$("#"+a.getContentElement("info","formElements2").domId);t($(this).val())?e.show(200):e.hide(200)}))},commit:function(t,e){e?t.setAttribute("src",decodeURI(this.getValue())):t.setAttribute("href",decodeURI(this.getValue()))}},{id:"txtAlt",type:"text",label:bcI18n.ckeditorDescriptionLabel,style:"margin-right : 10px;",setup:function(t,e){t&&(e?this.setValue(t.getAttribute("alt")):this.setValue(t.getText()))},commit:function(t,e){e?t.setAttribute("alt",this.getValue()):(t.setAttribute("title",this.getValue()),t.appendHtml(this.getValue()))}},{id:"chkCaption",type:"checkbox",label:bcI18n.ckeditorCaptionLabel,style:"margin-top:20px;"}]},{id:"formElements2",type:"hbox",padding:0,widths:["25%","25%","25%","25%"],children:[{id:"txtHspace",type:"text",label:bcI18n.ckeditorHspaceLabel,style:"margin-right : 10px;",setup:function(t,e){e&&t&&t.getAttribute("hspace")&&this.setValue(t.getAttribute("hspace"))},commit:function(t,e){if(e){var i="0";this.getValue()&&(i=this.getValue()),i>0&&(t.setStyle("margin-left",i+"px"),t.setStyle("margin-right",i+"px"),t.setAttribute("hspace",i))}}},{id:"txtVspace",type:"text",label:bcI18n.ckeditorVspaceLabel,style:"margin-right : 10px;",setup:function(t,e){e&&t&&t.getAttribute("vspace")&&this.setValue(t.getAttribute("vspace"))},commit:function(t,e){if(e){var i="0";this.getValue()&&(i=this.getValue()),i>0&&(t.setStyle("margin-top",i+"px"),t.setStyle("margin-bottom",i+"px"),t.setAttribute("vspace",i))}}},{id:"cmbAlign",type:"select",label:bcI18n.ckeditorAlignLabel,default:"",items:[[n.lang.common.notSet,""],[bcI18n.ckeditorLeft,"left"],[bcI18n.ckeditorAbsBottom,"absBottom"],[bcI18n.ckeditorAbsMiddle,"absMiddle"],[bcI18n.ckeditorBaseline,"baseline"],[bcI18n.ckeditorBottom,"bottom"],[bcI18n.ckeditorMiddle,"middle"],[bcI18n.ckeditorRight,"right"],[bcI18n.ckeditorTextTop,"textTop"],[bcI18n.ckeditorTop,"top"]],setup:function(t,e){e&&t&&this.setValue(t.getAttribute("align"))},commit:function(t,e){e&&t.setAttribute("align",this.getValue())}},{id:"rdoSize",type:"radio",label:bcI18n.ckeditorSizeLabel,default:"small",items:[[bcI18n.ckeditorOriginSize,""],[bcI18n.ckeditorSmall,"small"],[bcI18n.ckeditorMidium,"midium"],[bcI18n.ckeditorLarge,"large"]],setup:function(t,n){var a=this.getDialog(),l=$("#"+this.domId);l.find("input[type=radio]").prop("disabled",!0),l.find("input[type=radio]").eq(0).prop("disabled",!1),l.find("input[type=radio]").click((function(){$(this).prop("checked")&&a.setValueOf("info","txtUrl",i(a.getValueOf("info","txtUrl"),a.getValueOf("info","rdoSize")))})),t&&n&&($.get(baseUrl+adminPrefix+"/uploader/uploader_files/ajax_exists_images/"+e(t.getAttribute("src"),""),null,(function(t){t?(l.find("input[type=radio]").eq(1).prop("disabled",!t.small),l.find("input[type=radio]").eq(2).prop("disabled",!t.midium),l.find("input[type=radio]").eq(3).prop("disabled",!t.large)):l.find("input[type=radio]").prop("disabled",!0)}),"json"),this.setValue(function(t){var e=t.match(/__([a-z]*?)\.[a-zA-Z0-9]*?$/);return e?e[1]:""}(t.getAttribute("src"))))},commit:function(t,e){}}]},{id:"fileManager",type:"vbox",padding:0,children:[],setup:function(){var e=$("#"+this.domId),n='<div id="UploaderSearch" class="corner5" style="display:none"></div><div class="inner" style="text-align:center"><img style="margin-top:120px" src="'+baseUrl+'img/admin/ajax-loader.gif" /></div>';e.html(n);var a=this.getDialog(),l=Math.floor(99999999*Math.random()+1);$.ajax({type:"GET",dataType:"html",url:baseUrl+adminPrefix+"/uploader/uploader_files/ajax_get_search_box/"+l,success:function(t){$("#UploaderSearch").html(t),$("#UploaderSearch").slideDown()},error:function(t,e,i){alert(e)}}),$.ajax({type:"GET",dataType:"html",url:baseUrl+adminPrefix+"/uploader/uploader_files/index/"+l,success:function(n){e.find(".inner").html(n),$("#FileList"+l).bind("filelistload",(function(){$(".selectable-file").click((function(){var e=$(this).find("span.url").html(),n=$(this).find("span.name").html(),l=$("#"+a.getContentElement("info","formElements2").domId);if(t(n)){l.show(200);var o=$("#"+a.getContentElement("info","rdoSize").domId);o.find("input[type=radio]").prop("disabled",!0),o.find("input[type=radio]").eq(0).prop("disabled",!1),$(this).find(".small").html()?(o.find("input[type=radio]").eq(1).prop("checked",!0),o.find("input[type=radio]").eq(1).prop("disabled",!1)):o.find("input[type=radio]").eq(0).prop("checked",!0),$(this).find(".midium").html()&&o.find("input[type=radio]").eq(2).prop("disabled",!1),$(this).find(".large").html()&&o.find("input[type=radio]").eq(3).prop("disabled",!1)}else l.hide(200);a.setValueOf("info","txtUrl",i(e,a.getValueOf("info","rdoSize"))),a.setValueOf("info","txtAlt",$(this).find(".alt").html())})),$(".selectable-file").unbind("dblclick.dblclickEvent")})),$("#FileList"+l).bind("deletecomplete",(function(){a.setValueOf("info","txtUrl",""),a.setValueOf("info","txtAlt","")}))},error:function(t,e,i){alert(e)}})}}]}]}}))})();
//# sourceMappingURL=ckeditor_uploader.bundle.js.map