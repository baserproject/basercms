{"version":3,"file":"bc_custom_content/js/admin/custom_entries/form.bundle.js","mappings":";;;;;;;;;;AAaA,IAAMA,EAAoB,CAKtBC,QAAS,KAKTC,QAAO,WACHC,KAAKF,QAAUG,EAAE,iCAAiCC,KAAK,gBACvDF,KAAKG,gBACT,EAKAA,eAAc,WACVF,EAAE,eAAeG,MAAMJ,KAAKK,SAC5BJ,EAAE,eAAeG,MAAMJ,KAAKM,SAC5BL,EAAE,oBAAoBG,MAAMP,EAAkBU,WAClD,EAMAF,QAAO,WACHG,OAAOC,KAAK,GAAI,WAChB,IAAMC,EAAOT,EAAED,MAAMW,QAAQ,QACvBC,EAASF,EAAKR,KAAK,UAErBW,EAAe,mBACmB,SAAlCZ,EAAE,uBAAuBa,QACzBD,EAAc,kBAGlB,IAAME,EAAad,EAAEe,OAAOC,aAAe,+BAAiCpB,EAAkBC,QAAUe,EAClGK,EAAWjB,EAAEe,OAAOG,QAAU,kDAOpC,OANAT,EAAKR,KAAK,SAAU,WAAWA,KAAK,SAAUa,GAAYK,SAC1DV,EAAKR,KAAK,SAAU,SAASA,KAAK,SAAUU,GAE5CX,EAAEoB,IAAIH,GAAU,SAAUI,GACtBrB,EAAE,4BAA4Ba,IAAIQ,EACtC,KACO,CACX,EAKAhB,QAAO,WACH,IAAIiB,EAAetB,EAAED,MAAME,KAAK,YAC5BsB,EAAQvB,EAAED,MAAME,KAAK,cACrBuB,EAAQxB,EAAE,eAAiBsB,GAAcE,QAE7CA,EAAMC,KAAK,mCAAmCC,MAAK,WAC/C1B,EAAED,MAAME,KAAK,OAAQD,EAAED,MAAME,KAAK,QAAQ0B,QAAQ,eAAgBJ,SACxCK,IAAvB5B,EAAED,MAAME,KAAK,OACZD,EAAED,MAAME,KAAK,KAAMD,EAAED,MAAME,KAAK,MAAM0B,QAAQ,WAAYJ,GAElE,IAGAC,EAAMC,KAAK,SAASC,MAAK,WACrB1B,EAAED,MAAME,KAAK,MAAOD,EAAED,MAAME,KAAK,OAAO0B,QAAQ,WAAYJ,GAChE,IAEA,IAAMM,EAAK,WAAaP,EAAe,IAAMC,EAC7CC,EAAMvB,KAAK,KAAM4B,GACjBL,EAAMC,KAAK,oBAAoBC,MAAK,WAChC1B,EAAED,MAAME,KAAK,qBAAsB4B,GACnC7B,EAAED,MAAMI,MAAMP,EAAkBU,WACpC,IAEAN,EAAE,SAAWsB,GAAcQ,OAAON,GAClCA,EAAMO,UAAU,KAChB/B,EAAED,MAAME,KAAK,aAAc+B,OAAOT,GAAS,GAE3CvB,EAAE,IAAM6B,EAAK,4BAA4BI,SACzCjC,EAAEe,OAAOmB,iBAAiB,IAAML,EAAK,qBACzC,EAKAvB,WAAU,WACD6B,QAAQ,8BAGbnC,EAAE,IAAMA,EAAED,MAAME,KAAK,uBAAuBmC,QAAQ,KAAK,WACrDpC,EAAED,MAAMkC,QACZ,GACJ,GAIJrC,EAAkBE,S","sources":["webpack://bc-admin-third/./src/bc_custom_content/js/admin/custom_entries/form.js"],"sourcesContent":["/**\n * baserCMS :  Based Website Development Project <https://basercms.net>\n * Copyright (c) NPO baser foundation <https://baserfoundation.org/>\n *\n * @copyright     Copyright (c) NPO baser foundation\n * @link          https://basercms.net baserCMS Project\n * @since         5.0.0\n * @license       https://basercms.net/license/index.html MIT License\n */\n\n/**\n * Custom Entries Form\n */\nconst customEntriesForm = {\n\n    /**\n     * フルURL\n     */\n    fullUrl: null,\n\n    /**\n     * 初期化\n     */\n    mounted() {\n        this.fullUrl = $(\"#AdminCustomEntriesFormScript\").attr('data-fullUrl');\n        this.registerEvents();\n    },\n\n    /**\n     * イベント登録\n     */\n    registerEvents() {\n        $(\"#BtnPreview\").click(this.preview);\n        $(\"#BtnAddLoop\").click(this.addLoop);\n        $(\".btn-delete-loop\").click(customEntriesForm.deleteLoop);\n    },\n\n    /**\n     * プレビュー\n     * @returns {boolean}\n     */\n    preview() {\n        window.open('', 'preview');\n        const form = $(this).parents('form');\n        const action = form.attr('action');\n\n        var previewMode  = '&preview=default';\n        if ($(\"#ContentPreviewMode\").val() == 'draft') {\n            previewMode = '&preview=draft';\n        }\n\n        const previewUrl = $.bcUtil.adminBaseUrl + 'baser-core/preview/view?url=' + customEntriesForm.fullUrl + previewMode;\n        const tokenUrl = $.bcUtil.baseUrl + '/baser-core/bc_form/get_token?requestview=false'\n        form.attr('target', 'preview').attr('action', previewUrl).submit();\n        form.attr('target', '_self').attr('action', action);\n\n        $.get(tokenUrl, function (result) {\n            $('input[name=\"_csrfToken\"]').val(result);\n        });\n        return false;\n    },\n\n    /**\n     * ループを追加する\n     */\n    addLoop() {\n        var srcFieldName = $(this).attr('data-src');\n        var count = $(this).attr('data-count');\n        var clone = $(\"#BcCcLoopSrc\" + srcFieldName).clone();\n\n        clone.find('input, select, textarea, hidden').each(function () {\n            $(this).attr('name', $(this).attr('name').replace('__loop-src__', count));\n            if($(this).attr('id') !== undefined) {\n                $(this).attr('id', $(this).attr('id').replace('loop-src', count));\n            }\n        });\n\n        // label for属性もループ番号に変更\n        clone.find('label').each(function () {\n            $(this).attr('for', $(this).attr('for').replace('loop-src', count));\n        });\n\n        const id = \"BcCcLoop\" + srcFieldName + '-' + count;\n        clone.attr('id', id);\n        clone.find('.btn-delete-loop').each(function () {\n            $(this).attr('data-delete-target', id);\n            $(this).click(customEntriesForm.deleteLoop);\n        });\n\n        $(\"#loop-\" + srcFieldName).append(clone);\n        clone.slideDown(150);\n        $(this).attr('data-count', Number(count) + 1);\n\n        $(\"#\" + id + \" .bca-text-counter-value\").remove();\n        $.bcUtil.setUpTextCounter(\"#\" + id + ' .bca-text-counter');\n    },\n\n    /**\n     * ループを削除する\n     */\n    deleteLoop() {\n        if (!confirm('ループブロックを削除します。本当によろしいですか？')) {\n            return;\n        }\n        $(\"#\" + $(this).attr('data-delete-target')).slideUp(150, function () {\n            $(this).remove();\n        });\n    }\n\n}\n\ncustomEntriesForm.mounted();\n\n"],"names":["customEntriesForm","fullUrl","mounted","this","$","attr","registerEvents","click","preview","addLoop","deleteLoop","window","open","form","parents","action","previewMode","val","previewUrl","bcUtil","adminBaseUrl","tokenUrl","baseUrl","submit","get","result","srcFieldName","count","clone","find","each","replace","undefined","id","append","slideDown","Number","remove","setUpTextCounter","confirm","slideUp"],"sourceRoot":""}