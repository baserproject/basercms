/**
 * baserCMS :  Based Website Development Project <https://basercms.net>
 * Copyright (c) NPO baser foundation <https://baserfoundation.org/>
 *
 * @copyright     Copyright (c) NPO baser foundation
 * @link          https://basercms.net baserCMS Project
 * @since         5.0.0
 * @license       https://basercms.net/license/index.html MIT License
 */
$((function(){window.setTimeout((function(){window.scrollTo(0,1)}),100);var e=$("#AdminContentsEditScript").attr("data-fullurl"),t=$("#AdminContentsEditScript").attr("data-previewurl"),n=$.parseJSON($("#AdminContentsEditScript").attr("data-current")),i=$.parseJSON($("#AdminContentsEditScript").attr("data-settings"));$("form #ContentsFormTabs").tabs().show(),$("#BtnSave").click((function(){$.bcUtil.showLoader()})),$("#BtnPreview").click((function(){window.open("","preview");var n=$(this).parents("form"),i=n.attr("action"),a=$("#ContentPreviewMode").val(),o=t;return void 0===a&&(a="publish"),$("#ContentAliasId").val()&&(a="alias"),o.match(/\?/)?o+="&url="+e+"&preview="+a:o+="?url="+e+"&preview="+a,n.attr("target","preview"),n.attr("action",o),n.submit(),n.attr("target","_self"),n.attr("action",i),$.get($.bcUtil.baseUrl+"/baser-core/bc_form/get_token?requestview=false",(function(e){$('input[name="_csrfToken"]').val(e)})),!1})),$("#BtnDelete").click((function(){var e=bcI18n.contentsEditConfirmMessage1;if($("#ContentAliasId").val()&&(e=bcI18n.contentsEditConfirmMessage2),confirm(e)){$("#BtnDelete").prop("disabled",!0),$.bcUtil.showLoader();var t=$(this).parents("form");t.attr("action",$.bcUtil.adminBaseUrl+"baser-core/contents/delete"),t.submit()}return!1})),$(".create-alias").click((function(){var e=$(this).attr("data-site-id"),t=$("#sites-display-name"+e).val(),a=$("#sites-target-url"+e).val(),o={content:{name:n.name,title:n.title,plugin:n.plugin,type:n.type,site_id:e,alias_id:n.id,entity_id:n.entity_id,url:n.url}};return confirm(bcI18n.contentsEditConfirmMessage3.sprintf(t))&&$.bcToken.check((function(){return $.ajax({url:$.bcUtil.apiAdminBaseUrl+"baser-core/contents/is_unique_content",type:"POST",data:{url:a,_csrfToken:$.bcToken.key},beforeSend:function(){$.bcUtil.showLoader()},success:function(e){e?($.bcToken.key=null,$.bcToken.check((function(){return $.ajax({url:i.ContentAlias.url.add,type:"POST",data:$.extend(o,{_csrfToken:$.bcToken.key}),dataType:"json",beforeSend:function(){$("#Waiting").show()},success:function(e){$.bcUtil.hideLoader(),location.hash="#Page",$.bcUtil.showNoticeMessage(bcI18n.contentsEditInfoMessage1),location.href=$.bcUtil.adminBaseUrl+"baser-core/contents/edit_alias/"+e.content.id},error:function(e,t,n){$.bcUtil.hideLoader(),$.bcUtil.showAlertMessage(bcI18n.contentsEditAlertMessage1),$.bcToken.key=null}})}),{useUpdate:!1,hideLoader:!1})):($.bcUtil.hideLoader(),$.bcUtil.showAlertMessage(bcI18n.contentsEditAlertMessage2))},error:function(e,t,n){$.bcUtil.hideLoader(),$.bcUtil.showAlertMessage(bcI18n.contentsEditAlertMessage1)}})}),{useUpdate:!1,hideLoader:!1}),!1})),$(".create-copy").click((function(){var e=$(this).attr("data-site-id"),t=$("#sites-display-name"+e).val(),a=$("#sites-target-url"+e).val(),o={title:n.title,site_id:e,parent_id:n.parent_id,content_id:n.id,entity_id:n.entity_id,url:n.url};return confirm(bcI18n.contentsEditConfirmMessage4.sprintf(t))&&$.bcToken.check((function(){return $.ajax({url:$.bcUtil.apiAdminBaseUrl+"baser-core/contents/is_unique_content",type:"POST",data:{url:a,_csrfToken:$.bcToken.key},beforeSend:function(){$.bcUtil.showLoader()},success:function(e){e?($.bcToken.key=null,$.bcToken.check((function(){return $.ajax({url:i[n.type].url.copy,type:"POST",data:$.extend(o,{_csrfToken:$.bcToken.key}),dataType:"json",beforeSend:function(){$("#Waiting").show()},success:function(e){$.bcUtil.hideLoader(),location.hash="#Page",$.bcUtil.showNoticeMessage(bcI18n.contentsEditInfoMessage2),location.href=i[n.type].url.edit+"/"+e.content.entity_id},error:function(e,t,n){$.bcUtil.hideLoader(),$.bcToken.key=null,$.bcUtil.showAlertMessage(bcI18n.contentsEditAlertMessage4)}})}),{useUpdate:!1,hideLoader:!1})):($.bcUtil.hideLoader(),$.bcUtil.showAlertMessage(bcI18n.contentsEditAlertMessage3))},error:function(e,t,n){$.bcUtil.hideLoader(),$.bcUtil.showAlertMessage(bcI18n.contentsEditAlertMessage4)}})}),{useUpdate:!1,hideLoader:!1}),!1})),$("#pages-content-modified-date").val()||($("#pages-content-modified-date").val($.bcTimeUtil.getNowDate()),$("#pages-content-modified-date-time").val($.bcTimeUtil.getNowTime()))}));
//# sourceMappingURL=edit.bundle.js.map