{"version":3,"file":"js/admin/plugins/update.bundle.js","mappings":";;;;;;;;;GAWA,IAAMA,EAAa,CAKfC,OAAQ,KAKRC,mBAAmB,EAKnBC,aAAa,EAKbC,QAAO,WACH,IAAMC,EAASC,EAAE,6BACjBC,KAAKN,OAASI,EAAOG,KAAK,eAC1BD,KAAKJ,YAAcE,EAAOG,KAAK,yBACPC,IAArBF,KAAKJ,cAA2BI,KAAKJ,aAAc,GACtDI,KAAKG,iBACLH,KAAKI,cACT,EAKAD,eAAc,WACVJ,EAAE,cAAcM,GAAG,QAASL,KAAKM,QACjCP,EAAE,gBAAgBM,GAAG,QAASN,EAAEQ,OAAOC,YACvCT,EAAE,QAAQM,GAAG,SAAUL,KAAKI,aAChC,EAQAE,OAAM,WACF,QAAIG,QAAQC,OAAOC,mBACfZ,EAAEQ,OAAOC,cACF,EAGf,EAKAJ,aAAY,WACR,IAAMQ,EAAab,EAAE,cACfc,EAAed,EAAE,gBACjBe,EAAaf,EAAE,eACfgB,EAAYhB,EAAE,QAEM,cAAtBN,EAAWC,QACa,KAApBqB,EAAUC,OACPvB,EAAWG,YACVgB,EAAWK,WAAW,YAEtBL,EAAWX,KAAK,WAAY,YAEhCY,EAAaI,WAAW,cAExBL,EAAWX,KAAK,WAAY,YAC5BY,EAAaZ,KAAK,WAAY,aAE9Bc,EAAUC,MACVF,EAAWI,OAEXJ,EAAWK,QAGX1B,EAAWG,aACXgB,EAAWK,WAAW,YACtBJ,EAAaI,WAAW,cAExBL,EAAWX,KAAK,WAAY,YAC5BY,EAAaZ,KAAK,WAAY,YAG1C,GAIJR,EAAWI,S","sources":["webpack://bc-admin-third/./src/js/admin/plugins/update.js"],"sourcesContent":["/**\n * baserCMS :  Based Website Development Project <https://basercms.net>\n * Copyright (c) NPO baser foundation <https://baserfoundation.org/>\n *\n * @copyright     Copyright (c) NPO baser foundation\n * @link          https://basercms.net baserCMS Project\n * @since         5.0.0\n * @license       https://basercms.net/license/index.html MIT License\n */\nimport axios from \"axios\";\n\nconst updateForm = {\n\n    /**\n     * プラグイン名\n     */\n    plugin: null,\n\n    /**\n     * vendor / composer に書き込み権限があるか\n     */\n    isWritablePackage: false,\n\n    /**\n     * アップデートできるかどうか\n     */\n    isUpdatable: false,\n\n    /**\n     * 起動処理\n     */\n    mounted() {\n        const script = $(\"#AdminPluginsUpdateScript\");\n        this.plugin = script.attr('data-plugin');\n        this.isUpdatable = script.attr('data-isUpdatable');\n        if(this.isUpdatable === undefined) this.isUpdatable = false;\n        this.registerEvents();\n        this.toggleUpdate();\n    },\n\n    /**\n     * イベント登録\n     */\n    registerEvents() {\n        $(\"#BtnUpdate\").on('click', this.update);\n        $(\"#BtnDownload\").on('click', $.bcUtil.showLoader);\n        $(\"#php\").on('change', this.toggleUpdate);\n    },\n\n    /**\n     * アップデート実行\n     * コアのアップデートの場合、ダウンロードした最新版のファイルを適用してからリクエストを送信する\n     * マイグレーションファイルがプログラムに反映されないと実行できないため、別プロセスとして実行する\n     * @returns {boolean}\n     */\n    update() {\n        if (confirm(bcI18n.confirmMessage1)) {\n            $.bcUtil.showLoader();\n            return true;\n        }\n        return false;\n    },\n\n    /**\n     * アップデートボタン切り替え\n     */\n    toggleUpdate() {\n        const $btnUpdate = $(\"#BtnUpdate\");\n        const $btnDownload = $(\"#BtnDownload\");\n        const $phpNotice = $(\".php-notice\");\n        const $inputPhp = $(\"#php\");\n\n        if (updateForm.plugin === 'BaserCore') {\n            if ($inputPhp.val() !== ''){\n                if(updateForm.isUpdatable) {\n                    $btnUpdate.removeAttr('disabled');\n                } else {\n                    $btnUpdate.attr('disabled', 'disabled');\n                }\n                $btnDownload.removeAttr('disabled');\n            } else {\n                $btnUpdate.attr('disabled', 'disabled');\n                $btnDownload.attr('disabled', 'disabled');\n            }\n            if ($inputPhp.val()) {\n                $phpNotice.hide();\n            } else {\n                $phpNotice.show();\n            }\n        } else {\n            if (updateForm.isUpdatable) {\n                $btnUpdate.removeAttr('disabled');\n                $btnDownload.removeAttr('disabled');\n            } else {\n                $btnUpdate.attr('disabled', 'disabled');\n                $btnDownload.attr('disabled', 'disabled');\n            }\n        }\n    }\n\n};\n\nupdateForm.mounted();\n\n"],"names":["updateForm","plugin","isWritablePackage","isUpdatable","mounted","script","$","this","attr","undefined","registerEvents","toggleUpdate","on","update","bcUtil","showLoader","confirm","bcI18n","confirmMessage1","$btnUpdate","$btnDownload","$phpNotice","$inputPhp","val","removeAttr","hide","show"],"sourceRoot":""}