{"version":3,"file":"js/admin/sites/form.bundle.js","mappings":";;;;;;;;;;AAaA,IAAMA,EAAY,CAKdC,aAAe,GAKfC,QAAO,WACHC,KAAKC,WACLD,KAAKE,MAAQC,EAAE,UAAUC,KAC7B,EAKAH,SAAQ,WACJD,KAAKK,iBACLL,KAAKM,oBACLN,KAAKO,iBACT,EAKAF,eAAc,WACVF,EAAE,YAAYK,MAAMR,KAAKS,MACzBN,EAAE,iBAAiBO,OAAOV,KAAKM,mBAC/BH,EAAE,kBAAkBO,OAAOV,KAAKW,aAChCR,EAAE,+BAA+BK,MAAMR,KAAKW,aAC5CR,EAAE,+BAA+BK,MAAMR,KAAKO,gBAChD,EAMAE,KAAI,WACA,GAAIZ,EAAUK,OAASL,EAAUK,QAAUC,EAAE,UAAUC,MASnD,OARAD,EAAES,UAAUC,KAAK,CACb,MAASC,OAAOC,cAChB,QAAWD,OAAOE,gBAClB,GAAM,WACFb,EAAEc,OAAOC,aACTf,EAAE,YAAYgB,QAAQ,QAAQC,QAClC,KAEG,EAEXjB,EAAEc,OAAOC,YACb,EAKAZ,kBAAiB,WACb,IAAIe,EAAYlB,EAAE,OAAOC,MACrBkB,EAAanB,EAAE,iBAAiBC,WACjBmB,IAAfD,IACAA,EAAa,GAEjB,IAAIE,EAAMrB,EAAEc,OAAOQ,gBAAkB,oDAAsDH,OACzEC,IAAdF,IACAG,GAAO,IAAMH,GAEjBG,GAAO,QACPrB,EAAEc,OAAOS,KAAKF,GAAK,SAAUG,GACzB,IAAMC,EAAgBzB,EAAE,WAClB0B,EAAc1B,EAAE,SAClB2B,EAASF,EAAcxB,MACvB2B,EAAOF,EAAYzB,MACvBwB,EAAcI,KAAK,UAAUC,SAC7BJ,EAAYG,KAAK,UAAUC,SAC3BN,EAASxB,EAAE+B,UAAUP,GACrBxB,EAAEgC,KAAKR,EAAOS,SAAS,SAAUC,EAAOC,GACpCV,EAAcW,OAAOpC,EAAE,YAAYC,IAAIiC,GAAOG,KAAKF,GAAMG,KAAK,WAAaJ,IAAUP,GACzF,IACA3B,EAAEgC,KAAKR,EAAOe,OAAO,SAAUL,EAAOC,GAClCT,EAAYU,OAAOpC,EAAE,YAAYC,IAAIiC,GAAOG,KAAKF,GAAMG,KAAK,WAAaJ,IAAUN,GACvF,IACAlC,EAAUc,aACd,GAAG,CAACgC,KAAM,MAAOC,WAAY,QAASC,eAAgB,iBAC1D,EAKAlC,YAAW,WACP,IAAMmC,EAAgB3C,EAAE,kBAClB4C,EAAe5C,EAAE,kBACjB6C,EAAY7C,EAAE,cACd8C,EAAoB9C,EAAE,yBACtB+C,EAAgB/C,EAAE,qBAClBgD,EAAUhD,EAAE,WACdgD,EAAQ/C,OAASD,EAAE,SAASC,MAC5BD,EAAE,sBAAsBU,QAExBV,EAAE,sBAAsBiD,OACxBN,EAAcL,KAAK,WAAW,GAC9BM,EAAaN,KAAK,WAAW,GAC7BO,EAAUP,KAAK,WAAW,IAE1BM,EAAaN,KAAK,YAClBK,EAAcL,KAAK,WAAW,GAC9BQ,EAAkBG,OAClBJ,EAAUP,KAAK,WAAW,GAC1BS,EAAcE,SAEdH,EAAkBpC,OACI,WAAlBsC,EAAQ/C,OAAwC,eAAlB+C,EAAQ/C,MACtC8C,EAAcrC,OAEdqC,EAAcE,OAG1B,EAKA7C,gBAAe,WAC4C,MAAnDJ,EAAE,uCAAuCC,OAEzCD,EAAE,eAAeiD,OACjBjD,EAAE,6BAA6BsC,KAAK,WAAW,KAG/CtC,EAAE,eAAeU,YACoCU,IAAjDpB,EAAE,qCAAqCC,OACvCD,EAAE,kBAAkBsC,KAAK,WAAW,GAGhD,GAIJ5C,EAAUE,S","sources":["webpack://bc-admin-third/./src/js/admin/sites/form.js"],"sourcesContent":["/**\n * baserCMS :  Based Website Development Project <https://basercms.net>\n * Copyright (c) NPO baser foundation <https://baserfoundation.org/>\n *\n * @copyright     Copyright (c) NPO baser foundation\n * @link          https://basercms.net baserCMS Project\n * @since         5.0.0\n * @license       https://basercms.net/license/index.html MIT License\n */\n\n/**\n * sites form\n */\nconst sitesForm = {\n\n    /**\n     * 現在のエイリアス\n     */\n    currentAlias : '',\n\n    /**\n     * 初期化\n     */\n    mounted() {\n        this.initView();\n        this.alias = $(\"#alias\").val()\n    },\n\n    /**\n     * 表示初期化\n     */\n    initView() {\n        this.registerEvents();\n        this.loadDeviceAndLang();\n        this.changeUseDomain();\n    },\n\n    /**\n     * イベント登録\n     */\n    registerEvents() {\n        $(\"#BtnSave\").click(this.save);\n        $(\"#main-site-id\").change(this.loadDeviceAndLang);\n        $(\"#device, #lang\").change(this.loadOptions);\n        $('input[name=\"same_main_url\"]').click(this.loadOptions);\n        $(\"input[name='use_subdomain']\").click(this.changeUseDomain);\n    },\n\n    /**\n     * 保存\n     * @returns {boolean}\n     */\n    save() {\n        if (sitesForm.alias && sitesForm.alias !== $(\"#alias\").val()) {\n            $.bcConfirm.show({\n                'title': bcI18n.confirmTitle1,\n                'message': bcI18n.confirmMessage2,\n                'ok': function () {\n                    $.bcUtil.showLoader();\n                    $(\"#BtnSave\").parents(\"form\").submit();\n                }\n            });\n            return false;\n        }\n        $.bcUtil.showLoader();\n    },\n\n    /**\n     * デバイスと言語の表示設定\n     */\n    loadDeviceAndLang() {\n        let currentId = $(\"#id\").val();\n        let mainSiteId = $(\"#main-site-id\").val();\n        if (mainSiteId === undefined) {\n            mainSiteId = 1;\n        }\n        let url = $.bcUtil.apiAdminBaseUrl + 'baser-core/sites/get_selectable_devices_and_lang/' + mainSiteId;\n        if (currentId !== undefined) {\n            url += '/' + currentId;\n        }\n        url += '.json';\n        $.bcUtil.ajax(url, function (result) {\n            const $selectDevice = $(\"#device\");\n            const $selectLang = $(\"#lang\");\n            let device = $selectDevice.val();\n            let lang = $selectLang.val();\n            $selectDevice.find('option').remove();\n            $selectLang.find('option').remove();\n            result = $.parseJSON(result);\n            $.each(result.devices, function (value, name) {\n                $selectDevice.append($('<option>').val(value).text(name).prop('selected', (value === device)));\n            });\n            $.each(result.langs, function (value, name) {\n                $selectLang.append($('<option>').val(value).text(name).prop('selected', (value === lang)));\n            });\n            sitesForm.loadOptions();\n        }, {type: 'GET', loaderType: 'after', loaderSelector: '#main-site-id'});\n    },\n\n    /**\n     * デバイスと言語のオプションの表示設定\n     */\n    loadOptions() {\n        const $autoRedirect = $(\"#auto-redirect\");\n        const $sameMainUrl = $(\"#same-main-url\");\n        const $autoLink = $(\"#auto-link\");\n        const $spanAutoRedirect = $(\"#SpanSiteAutoRedirect\");\n        const $spanAutoLink = $(\"#SpanSiteAutoLink\");\n        const $device = $(\"#device\");\n        if ($device.val() || $(\"#lang\").val()) {\n            $(\"#SectionAccessType\").show();\n        } else {\n            $(\"#SectionAccessType\").hide();\n            $autoRedirect.prop('checked', false);\n            $sameMainUrl.prop('checked', false);\n            $autoLink.prop('checked', false);\n        }\n        if ($sameMainUrl.prop('checked')) {\n            $autoRedirect.prop('checked', false);\n            $spanAutoRedirect.hide();\n            $autoLink.prop('checked', false);\n            $spanAutoLink.hide();\n        } else {\n            $spanAutoRedirect.show();\n            if ($device.val() === 'mobile' || $device.val() === 'smartphone') {\n                $spanAutoLink.show();\n            } else {\n                $spanAutoLink.hide();\n            }\n        }\n    },\n\n    /**\n     * サイトで外部ドメイン使用するかどうかの表示切り替え\n     */\n    changeUseDomain() {\n        if ($(\"input[name='use_subdomain']:checked\").val() === '0') {\n            //ドメインを利用しない場合は、ドメインタイプは利用しない\n            $(\"#DomainType\").hide();\n            $(\"input[name='domain_type']\").prop(\"checked\", false);\n        } else {\n            //ドメインを利用する場合は、ドメインタイプのラジオボタンを表示\n            $(\"#DomainType\").show();\n            if ($(\"input[name='domain_type']:checked\").val() === undefined) {\n                $(\"#domain-type-1\").prop(\"checked\", true);\n            }\n        }\n    }\n\n}\n\nsitesForm.mounted();\n"],"names":["sitesForm","currentAlias","mounted","this","initView","alias","$","val","registerEvents","loadDeviceAndLang","changeUseDomain","click","save","change","loadOptions","bcConfirm","show","bcI18n","confirmTitle1","confirmMessage2","bcUtil","showLoader","parents","submit","currentId","mainSiteId","undefined","url","apiAdminBaseUrl","ajax","result","$selectDevice","$selectLang","device","lang","find","remove","parseJSON","each","devices","value","name","append","text","prop","langs","type","loaderType","loaderSelector","$autoRedirect","$sameMainUrl","$autoLink","$spanAutoRedirect","$spanAutoLink","$device","hide"],"sourceRoot":""}