{"version":3,"file":"bc_blog/js/admin/blog_posts/form.bundle.js","mappings":"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","sources":["webpack://bc-admin-third/./src/bc_blog/js/admin/blog_posts/form.js"],"sourcesContent":["/**\n * baserCMS :  Based Website Development Project <https://basercms.net>\n * Copyright (c) NPO baser foundation <https://baserfoundation.org/>\n *\n * @copyright     Copyright (c) NPO baser foundation\n * @link          https://basercms.net baserCMS Project\n * @since         5.0.0\n * @license       https://basercms.net/license/index.html MIT License\n */\n\n$(function () {\n\n    var fullUrl = $(\"#AdminBlogBLogPostsEditScript\").attr('data-fullurl');\n    var previewurlBase = $(\"#AdminBlogBLogPostsEditScript\").attr('data-previewurl');\n    let blogContentId = $(\"#AdminBlogBLogPostsEditScript\").attr('data-blogContentId');\n\n    $(\"input[type=text]\").each(function () {\n        $(this).keypress(function (e) {\n            if (e.which && e.which === 13) {\n                return false;\n            }\n            return true;\n        });\n    });\n\n    if (!document.queryCommandSupported('copy')) {\n        $(\"#BtnCopyUrl\").hide();\n    }\n    $(\"#BtnCopyUrl\").click(function () {\n        var copyArea = $(\"<textarea style=\\\" opacity:0; width:1px; height:1px; margin:0; padding:0; border-style: none;\\\"/>\");\n        copyArea.text(fullUrl);\n        $(this).after(copyArea);\n        copyArea.select();\n        document.execCommand(\"copy\");\n        copyArea.remove();\n        return false;\n    });\n\n    $(\"#BtnPreview\").click(function () {\n        window.open('', 'preview');\n        var form = $(this).parents('form');\n        var action = form.attr('action');\n        var previewMode = 'default';\n        var previewurl = previewurlBase;\n\n        if ($(\"#ContentPreviewMode\").val() == 'draft') {\n            previewMode = 'draft';\n        }\n        if (previewurl.match(/\\?/)) {\n            previewurl += '&url=' + fullUrl +  '&preview=' + previewMode;\n        } else {\n            previewurl += '?url=' + fullUrl +  '&preview=' + previewMode;\n        }\n        if (typeof $.bcCkeditor.editor['editor_detail_tmp'] !== undefined) {\n            $.bcCkeditor.editor['editor_detail_tmp'].execCommand('synchronize');\n        }\n        form.attr('target', 'preview');\n        form.attr('action', previewurl);\n        form.submit();\n        form.attr('target', '_self');\n        form.attr('action', action);\n        $.get($.baseUrl() + '/baser-core/bc_form/get_token?requestview=false', function (result) {\n            $('input[name=\"_csrfToken\"]').val(result);\n        });\n        return false;\n    });\n\n    /**\n     * フォーム送信時イベント\n     */\n    $(\"#BtnSave\").click(function () {\n        $.bcUtil.showLoader();\n        if (typeof $.bcCkeditor.editor['editor_detail_tmp'] !== undefined) {\n            $.bcCkeditor.editor['editor_detail_tmp'].execCommand('synchronize');\n        }\n        $(\"#BlogPostMode\").val('save');\n        $.bcToken.check(function () {\n            $(\"#BlogPostForm\").submit();\n        }, {useUpdate: false, hideLoader: false});\n        return false;\n    });\n\n    /**\n     * ブログタグ追加\n     */\n    $(\"#BlogTagName\").keypress(function (ev) {\n        if ((ev.which && ev.which === 13) || (ev.keyCode && ev.keyCode === 13)) {\n            $(\"#BtnAddBlogTag\").click();\n            return false;\n        } else {\n            return true;\n        }\n    });\n\n    $(\"#BtnAddBlogTag\").click(function () {\n        if (!$(\"#blog-tag-name\").val()) {\n            return false;\n        }\n        $.bcToken.check(function () {\n            return $.ajax({\n                type: \"POST\",\n                url: $.bcUtil.apiBaseUrl + 'bc-blog/blog_tags/add.json',\n                headers: {\n                    \"Authorization\": $.bcJwt.accessToken,\n                },\n                data: {\n                    'name': $(\"#blog-tag-name\").val(),\n                    '_csrfToken': $.bcToken.key\n                },\n                dataType: 'json',\n                beforeSend: function () {\n                    $(\"#BtnAddBlogTag\").prop('disabled', true);\n                    if(!$(\"#BtnAddBlogTagloaderkey\").length) {\n                        $.bcUtil.showLoader('after', '#BtnAddBlogTag', 'BtnAddBlogTagloaderkey');\n                    }\n                },\n                success: function (result) {\n                    if (result) {\n                        let checkbox = $('<span class=\"bca-checkbox\"/>')\n                            .append($('<input type=\"checkbox\" name=\"blog_tags[_ids][]\" class=\"bca-checkbox__input\" />')\n                                .val(result.blogTag.id)\n                                .attr('id', 'blog-tags-ids-' + result.blogTag.id))\n                            .append($('<label class=\"bca-checkbox__label\">')\n                                .attr('for', 'blog-tags-ids-' + result.blogTag.id)\n                                .html(result.blogTag.name));\n                        $(\"#BlogTags\").append(checkbox);\n                        $('input[name=\"blog_tags[_ids][]\"]').last().prop('checked', true);\n                        $(\"#blog-tag-name\").val('');\n                    } else {\n                        alert(bcI18n.alertMessage1);\n                    }\n                },\n                error: function () {\n                    alert(bcI18n.alertMessage2);\n                },\n                complete: function (xhr, textStatus) {\n                    $(\"#BtnAddBlogTag\").removeAttr('disabled');\n                    $.bcUtil.hideLoader('after', '#BtnAddBlogTag', 'BtnAddBlogTagloaderkey');\n                    $(\"#BlogTags\").effect(\"highlight\", {}, 1500);\n                }\n            });\n        }, {loaderType: 'after', loaderSelector: '#BtnAddBlogTag', hideLoader: false});\n        return false;\n    });\n\n    /**\n     * ブログカテゴリダイアログ\n     */\n    $(\"#BtnAddBlogCategory\").click(function () {\n        $(\"#AddBlogCategoryForm\").dialog({\n            width: 'auto',\n            modal: true,\n            open: function () {\n                // ヘルプがダイアログ内で切れてしまうのを防ぐ\n                $(this).css('overflow', 'visible');\n                $(this.parentNode).css('overflow', 'visible');\n            },\n            close: function () {\n                $(\"#blogcategory-title\").val('');\n                $(\"#blogcategory-name\").val('');\n            },\n            buttons: {\n                cancel: {\n                    text: bcI18n.commonCancel,\n                    click: function () {\n                        $(this).dialog('close');\n                    }\n                },\n                save: {\n                    text: bcI18n.commonSave,\n                    click: function () {\n                        addCategory(\n                            blogContentId,\n                            $('#blogcategory-name').val(),\n                            $('#blogcategory-title').val()\n                        );\n                        return false;\n                    }\n                }\n            }\n        });\n        return false;\n    });\n\n    /**\n     * カテゴリを追加する\n     * @param blogContentId\n     * @param name\n     * @param title\n     */\n    function addCategory(blogContentId, name, title)\n    {\n        if (!name) name = title;\n        $.bcToken.check(function () {\n            return $.ajax({\n                type: \"post\",\n                url: $.bcUtil.apiBaseUrl + 'bc-blog/blog_categories/add/' + blogContentId + '.json',\n                headers: {\n                    \"Authorization\": $.bcJwt.accessToken,\n                },\n                data: {\n                    'name': name,\n                    'title': title,\n                    '_csrfToken': $.bcToken.key\n                },\n                beforeSend: function () {\n                    $(\"#BtnAddBlogCategory\").prop('disabled', true);\n                    $.bcUtil.showLoader();\n                },\n                success: function (result) {\n                    if (result) {\n                        $(\"#blog-category-id\").append($('<option />')\n                            .val(result.blogCategory.id)\n                            .text(result.blogCategory.title)\n                            .prop('selected', true)\n                        );\n                    } else {\n                        alert(bcI18n.alertMessage3);\n                    }\n                    $(\"#AddBlogCategoryForm\").dialog('close');\n                },\n                error: function (XMLHttpRequest) {\n                    if(XMLHttpRequest.responseJSON.errors) {\n                        let messages = [];\n                        let errors = XMLHttpRequest.responseJSON.errors;\n                        Object.keys(errors).forEach(function (field) {\n                            Object.keys(errors[field]).forEach(function (type) {\n                              messages.push(errors[field][type]);\n                            });\n                        });\n                        alert(bcI18n.alertMessage4 + '\\n\\n' + messages.join('\\n'));\n                    } else {\n                        alert(bcI18n.alertMessage4);\n                    }\n                },\n                complete: function (xhr, textStatus) {\n                    $(\"#BtnAddBlogCategory\").removeAttr('disabled');\n                    $.bcUtil.hideLoader();\n                    $(\"#BlogPostBlogCategoryId\").effect(\"highlight\", {}, 1500);\n                }\n            });\n        }, {hideLoader: false});\n    }\n});\n"],"names":["$","fullUrl","attr","previewurlBase","blogContentId","each","this","keypress","e","which","document","queryCommandSupported","hide","click","copyArea","text","after","select","execCommand","remove","window","open","form","parents","action","previewMode","previewurl","val","match","undefined","bcCkeditor","editor","submit","get","baseUrl","result","bcUtil","showLoader","bcToken","check","useUpdate","hideLoader","ev","keyCode","ajax","type","url","apiBaseUrl","headers","bcJwt","accessToken","data","key","dataType","beforeSend","prop","length","success","checkbox","append","blogTag","id","html","name","last","alert","bcI18n","alertMessage1","error","alertMessage2","complete","xhr","textStatus","removeAttr","effect","loaderType","loaderSelector","dialog","width","modal","css","parentNode","close","buttons","cancel","commonCancel","save","commonSave","title","blogCategory","alertMessage3","XMLHttpRequest","responseJSON","errors","messages","Object","keys","forEach","field","push","alertMessage4","join","addCategory"],"sourceRoot":""}