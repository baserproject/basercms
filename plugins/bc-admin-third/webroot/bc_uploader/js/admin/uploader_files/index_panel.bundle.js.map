{"version":3,"file":"bc_uploader/js/admin/uploader_files/index_panel.bundle.js","mappings":"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","sources":["webpack://bc-admin-third/./src/bc_uploader/js/admin/uploader_files/index_panel.js"],"sourcesContent":["/**\n * baserCMS :  Based Website Development Project <https://basercms.net>\n * Copyright (c) NPO baser foundation <https://baserfoundation.org/>\n *\n * @copyright     Copyright (c) NPO baser foundation\n * @link          https://basercms.net baserCMS Project\n * @since         5.0.0\n * @license       https://basercms.net/license/index.html MIT License\n */\n\n/**\n * 起動時処理\n */\nuploaderFilesIndex = {\n\n    /**\n     * list id\n     */\n    listId: null,\n\n    /**\n     * all fields\n     */\n    allFields: null,\n\n    /**\n     * category id\n     */\n    categoryId: null,\n\n    /**\n     * 起動処理\n     */\n    mounted() {\n        //==========================================================================\n        // 複数のエディタよりリストが呼出される可能性がある為、#ListIdの値を読み込んだら削除する\n        // TODO 強引すぎるので他の方法がないか検討要\n        //==========================================================================\n        const $listId = $(\"#ListId\");\n        this.listId = $listId.html();\n        $listId.remove();\n        this.allFields = $([]).add($(\"#name\")).add($(\"#alt\"));\n        this.initView();\n        this.registerEvents();\n    },\n\n    /**\n     * 表示を初期化\n     */\n    initView() {\n        // 一覧を更新する\n        this.updateFileList();\n        this.initDialog();\n    },\n    /**\n     * イベント登録\n     */\n    registerEvents() {\n        $(\"#BtnFilter\").click(function () {\n            uploaderFilesIndex.updateFileList();\n            return false;\n        });\n    },\n\n    /**\n     * ダイアログを初期化\n     */\n    initDialog() {\n        $(\"#EditDialog\").dialog({\n            bgiframe: true,\n            autoOpen: false,\n            position: {at: \"center center\", of: window},\n            width: 960,\n            modal: true,\n            open: function () {\n                let listId = uploaderFilesIndex.listId;\n                var name = $(\"#FileList\" + listId + \" .selected .name\").html();\n                $(\"#UploaderFileImage\" + listId + ' .uploader-file-image-inner').remove();\n                $(\"#UploadFileImageLoader\" + listId).show();\n                $(\"#UploaderFileId\" + listId).val($(\"#FileList\" + listId + \" .selected .id\").html().trim());\n                $(\"#UploaderFileName\" + listId).val(name);\n                $(\"#UploaderFileAlt\" + listId).val($(\"#FileList\" + listId + \" .selected .alt\").html());\n\n                /* ダイアログ初期化時、hidden値が空になるため公開期間開始日時を取得して hidden値に入れ込む */\n                var publishBeginDate = $(\"#FileList\" + listId + \" .selected .publish-begin\").html().trim();\n                var publishBeginTime = $(\"#FileList\" + listId + \" .selected .publish-begin-time\").html().trim();\n                $(\"#UploaderFilePublishBegin-date\").val(publishBeginDate);\n                $(\"#UploaderFilePublishBegin-time\").val(publishBeginTime);\n                var publishBeginDateTime = publishBeginDate;\n                if (publishBeginTime) {\n                    publishBeginDateTime += ' ' + publishBeginTime;\n                }\n                $(\"#UploaderFilePublishBegin\").val(publishBeginDateTime);\n\n                /* ダイアログ初期化時、hidden値が空になるため公開期間終了日時を取得して hidden値に入れ込む */\n                var publishEndDate = $(\"#FileList\" + listId + \" .selected .publish-end\").html().trim();\n                var publishEndTime = $(\"#FileList\" + listId + \" .selected .publish-end-time\").html().trim();\n                $(\"#UploaderFilePublishEnd-date\").val(publishEndDate);\n                $(\"#UploaderFilePublishEnd-time\").val(publishEndTime);\n                var publishEndDateTime = publishEndDate;\n                if (publishEndTime) {\n                    publishEndDateTime += ' ' + publishEndTime;\n                }\n                $(\"#UploaderFilePublishEnd\").val(publishEndDateTime);\n\n                $(\"#UploaderFileUserId\" + listId).val($(\"#FileList\" + listId + \" .selected .user-id\").html());\n                $(\"#UploaderFileUserName\" + listId).html($(\"#FileList\" + listId + \" .selected .user-name\").html());\n                let $uploaderCategoryId = $(\"#_UploaderFileUploaderCategoryId\" + listId);\n                if ($uploaderCategoryId.length) {\n                    $uploaderCategoryId.val($(\"#FileList\" + listId + \" .selected .uploader-category-id\").html());\n                }\n                $.ajax({\n                    url: $.bcUtil.adminBaseUrl + 'bc-uploader/uploader_files/ajax_image/' + name + '/large',\n                    type: 'get',\n                    dataType: 'html',\n                    success: function (res) {\n                        $(\"#UploadFileImageLoader\" + listId).hide()\n                            .after(res);\n                    }\n                });\n            },\n            buttons: {\n                cancel: {\n                    text: bcI18n.uploaderCancel,\n                    click: function () {\n                        $(this).dialog('close');\n                    }\n                },\n                save: {\n                    text: bcI18n.uploaderSave,\n                    click: function () {\n                        let listId = uploaderFilesIndex.listId;\n                        // 保存処理\n                        let saveButton = $(this);\n                        let id = $(\"#UploaderFileId\" + listId).val();\n                        $.bcToken.check(function () {\n                            // IEでform.serializeを利用した場合、Formタグの中にTableタグがあるとデータが取得できなかった\n                            var data = {\n                                \"id\": id,\n                                \"name\": $(\"#UploaderFileName\" + listId).val(),\n                                \"alt\": $(\"#UploaderFileAlt\" + listId).val(),\n                                \"publish_begin\": $(\"#UploaderFilePublishBegin\" + listId).val(),\n                                \"publish_end\": $(\"#UploaderFilePublishEnd\" + listId).val(),\n                                \"user_id\": $(\"#UploaderFileUserId\" + listId).val(),\n                                \"uploader_category_id\": $(\"#_UploaderFileUploaderCategoryId\" + listId).val(),\n                                \"_csrfToken\": $.bcToken.key\n                            };\n                            return $.ajax({\n                                url: $.bcUtil.apiAdminBaseUrl + 'bc-uploader/uploader_files/edit/' + id + '.json',\n                                type: 'post',\n                                data: data,\n                                dataType: 'json',\n                                success: function () {\n                                    uploaderFilesIndex.updateFileList();\n                                    uploaderFilesIndex.allFields.removeClass('ui-state-error');\n                                    saveButton.dialog('close');\n                                },\n                                error: function (response) {\n                                    const fields = {\n                                        name: bcI18n.uploaderFile,\n                                        publish_begin: bcI18n.uploaderPublishBegin,\n                                        publish_end: bcI18n.uploaderPublishEnd\n                                    };\n                                    let message = response.responseJSON.message;\n                                    if (response.responseJSON.errors !== undefined) {\n                                        message += \"\\n\";\n                                        Object.keys(response.responseJSON.errors).forEach(function (key) {\n                                            Object.keys(response.responseJSON.errors[key]).forEach(function (field) {\n                                                message += \"\\n・\" + fields[key] + '：' + response.responseJSON.errors[key][field];\n                                            });\n                                        });\n                                    }\n                                    alert(message);\n                                }\n                            });\n                        }, {hideLoader: false, useUpdate: false});\n                    }\n                }\n            },\n            close: function () {\n                uploaderFilesIndex.allFields.val('').removeClass('ui-state-error');\n            }\n\n        });\n    },\n\n    /**\n     * アップロードファイル選択時イベント\n     */\n    uploaderFileFileChangeHandler() {\n        var url = $.bcUtil.apiAdminBaseUrl + 'bc-uploader/uploader_files/upload.json';\n        var $file = $(this);\n        let listId = uploaderFilesIndex.listId;\n        $.bcUtil.showLoader();\n        if ($('#UploaderFileFile' + listId).val()) {\n            $.bcToken.check(function () {\n                let fd = new FormData();\n                fd.append('file', $file.prop('files')[0]);\n                fd.append('_csrfToken', $.bcToken.key);\n                $uploaderCategoryId = $(\"#UploaderFileUploaderCategoryId\" + listId);\n                if ($uploaderCategoryId.length) {\n                    fd.append('uploader_category_id', $uploaderCategoryId.val());\n                }\n                return $.ajax({\n                    url: url,\n                    type: 'post',\n                    data: fd,\n                    dataType: 'json',\n                    processData: false,\n                    contentType: false,\n                    cache: false,\n                    beforeSend: function () {\n                        $.bcUtil.hideMessage();\n                    },\n                    success: uploaderFilesIndex.uploadSuccessHandler,\n                    error: function (response) {\n                        if (response.responseJSON) {\n                            $.bcUtil.showApiError(response);\n                        } else {\n                            $.bcUtil.showAlertMessage('処理中にエラーが発生しました。ファイルが大きすぎる可能性があります。');\n                        }\n                        $.bcUtil.hideLoader()\n                    },\n                });\n            }, {useUpdate: false, hideLoader: false});\n        }\n    },\n\n    /**\n     * アップロード完了後イベント\n     */\n    uploadSuccessHandler(res) {\n        let listId = uploaderFilesIndex.listId;\n        if (res) {\n            let $uploaderCategoryId = $('#UploaderFileUploaderCategoryId' + listId);\n            if ($uploaderCategoryId.length) {\n                $('#FilterUploaderCategoryId' + listId).val($uploaderCategoryId.val());\n                uploaderFilesIndex.categoryId = $uploaderCategoryId.val();\n            }\n            uploaderFilesIndex.updateFileList();\n        } else {\n            $('#ErrorMessage').remove();\n            $('#FileList' + listId).prepend('<p id=\"ErrorMessage\" class=\"message\">' + bcI18n.uploaderAlertMessage2 + '</p>');\n            $(\"#Waiting\").hide();\n        }\n        // フォームを初期化\n        // セキュリティ上の関係でvalue値を直接消去する事はできないので、一旦エレメントごと削除し、\n        // spanタグ内に新しく作りなおす。\n        $(\"#UploaderFileFile\" + listId).remove();\n        $(\"#SpanUploadFile\" + listId).append('<input id=\"UploaderFileFile' + listId + '\" type=\"file\" value=\"\" name=\"data[UploaderFile][file]\" class=\"uploader-file-file\" />');\n        $('#UploaderFileFile' + listId).change(uploaderFilesIndex.uploaderFileFileChangeHandler);\n        $.bcToken.key = null;\n    },\n    /**\n     * 一覧を更新する\n     */\n    updateFileList() {\n        $.bcUtil.ajax(uploaderFilesIndex.getListUrl(), uploaderFilesIndex.updateFileListCompleteHandler, {hideLoader: false, type: 'GET'});\n    },\n\n    /**\n     * 指定したファイルの編集ができない状態か確認\n     *\n     * @param fileUserId\n     * @returns {boolean}\n     */\n    isFileEditDisabled(fileUserId) {\n        var loginUserId = $(\"#LoginUserId\").html();\n        var loginUserGroupId = $(\"#LoginUserGroupId\").html();\n        var usePermission = Number($(\"#UsePermission\").html());\n        var disabled = false;\n        if (parseInt(loginUserGroupId) !== 1 && usePermission) {\n            if (parseInt(loginUserId) !== fileUserId) {\n                disabled = true;\n            }\n        }\n        return disabled;\n    },\n\n    /**\n     * 選択イベントを初期化する\n     */\n    initFileList() {\n        let listId = uploaderFilesIndex.listId;\n        if (uploaderFilesIndex.categoryId) {\n            $('#UploaderFileUploaderCategoryId' + listId).val(uploaderFilesIndex.categoryId);\n        }\n        let $selectableFile = $(\".selectable-file\");\n        /* 一旦イベントを全て解除 */\n        $selectableFile.unbind('click.selectEvent');\n        $selectableFile.unbind('mouseenter.selectEvent');\n        $selectableFile.unbind('mouseleave.selectEvent');\n        $selectableFile.unbind('dblclick.dblclickEvent');\n        $(\".page-numbers a\").unbind('click.paginationEvent');\n        $(\".filter-control\").unbind('click.filterEvent');\n        $(\".btn-delete\").unbind('click');\n\n        /* 公開制限期間にあるファイルの背景色を定義 */\n        var unpublishBackGroundColor = '#bbb';\n\n        $divPanelList = $(\"#DivPanelList\");\n        if ($.fn.contextMenu && !listId && $divPanelList.length) {\n            /* 右クリックメニューを追加 */\n            $divPanelList.contextMenu({\n                selector: '.selectable-file',\n                callback: uploaderFilesIndex.contextMenuHandler,\n                build: function ($trigger, e) {\n                    var disabled = uploaderFilesIndex.isFileEditDisabled($($trigger).find('.user-id').html());\n                    return {\n                        items: {\n                            edit: {\n                                name: bcI18n.uploaderEdit,\n                                icon: 'edit',\n                                disabled: function (key, opt) {\n                                    return disabled;\n                                }\n                            },\n                            delete: {\n                                name: bcI18n.uploaderDelete,\n                                icon: 'delete',\n                                disabled: function (key, opt) {\n                                    return disabled;\n                                }\n                            }\n                        }\n                    }\n                }\n            });\n        }\n\n        $selectableFileInPanelList = $(\"#DivPanelList .selectable-file\");\n        $selectableFileInPanelList.each(function () {\n            if ($.fn.contextMenu && !listId) {\n                if (!uploaderFilesIndex.isFileEditDisabled($(this).find('.user-id').html())) {\n                    $(this).bind('dblclick.dblclickEvent', function () {\n                        $('#EditDialog').dialog('open');\n                    });\n                } else {\n                    $(this).bind('dblclick.dblclickEvent', function () {\n                        alert(bcI18n.uploaderAlertMessage3);\n                    });\n                }\n            } else {\n                $(this).bind(\"contextmenu\", function (e) {\n                    return false;\n                });\n            }\n\n            /* 公開制限期間にあるファイルは背景色をグレーにする */\n            if ($(this).hasClass('unpublish')) {\n                $(this).css('background-color', unpublishBackGroundColor);\n            }\n        });\n\n        // ファイルアップロードイベントを登録\n        $('#UploaderFileFile' + listId).change(uploaderFilesIndex.uploaderFileFileChangeHandler);\n\n        if (listId) {\n            $selectableFile.bind('mouseenter.selectEvent', function () {\n                $(this).css('background-color', '#fffae7');\n            });\n            $selectableFile.bind('mouseleave.selectEvent', function () {\n                $(this).css('background-color', '#FFFFFF');\n                if ($(this).hasClass('unpublish')) {\n                    $(this).css('background-color', unpublishBackGroundColor);\n                }\n            });\n            $selectableFile.each(function () {\n                // IEの場合contextmenuを検出できなかったので、mousedownに変更した\n                $(this).bind('mousedown', function () {\n                    $selectableFile.removeClass('selected');\n                    $(this).addClass('selected');\n                });\n            });\n        } else {\n            $selectableFileInPanelList.bind('mouseenter.selectEvent', function () {\n                $(this).css('background-color', '#fffae7');\n            });\n            $selectableFileInPanelList.bind('mouseleave.selectEvent', function () {\n                $(this).css('background-color', '#FFFFFF');\n                if ($(this).hasClass('unpublish')) {\n                    $(this).css('background-color', unpublishBackGroundColor);\n                }\n            });\n            $selectableFileInPanelList.each(function () {\n                // IEの場合contextmenuを検出できなかったので、mousedownに変更した\n                $(this).bind('mousedown', function () {\n                    $selectableFile.removeClass('selected');\n                    $(this).addClass('selected');\n                });\n            });\n        }\n\n        /* ページネーションイベントを追加 */\n        $('.page-numbers a').bind('click.paginationEvent', function () {\n            $(\"#Waiting\").show();\n            $.get($(this).attr('href'), uploaderFilesIndex.updateFileListCompleteHandler);\n            return false;\n        });\n\n        $('.bca-list-num a').on('click.listNumEvent', function () {\n            $(\"#Waiting\").show();\n            $.get($(this).attr('href'), uploaderFilesIndex.updateFileListCompleteHandler);\n            return false;\n        });\n\n        /*$('#FilterUploaderCategoryId'+listId).bind('change.filterEvent', function() {\n            $(\"#Waiting\").show();\n            $.get(uploaderFilesIndex.getListUrl(), uploaderFilesIndex.updateFileListCompleteHandler);\n        });\n        $('input[name=\"data[Filter][uploader_type]\"]').bind('click.filterEvent', function() {\n            $(\"#Waiting\").show();\n            $.get(uploaderFilesIndex.getListUrl(), uploaderFilesIndex.updateFileListCompleteHandler);\n        });*/\n        let $fileList = $(\"#FileList\" + listId);\n        $fileList.trigger(\"filelistload\");\n        $fileList.effect(\"highlight\", {}, 1500);\n    },\n\n    /**\n     * ファイルリスト取得完了イベント\n     */\n    updateFileListCompleteHandler(result) {\n        let listId = uploaderFilesIndex.listId;\n        let $fileList = $(\"#FileList\" + listId);\n        $fileList.html(result);\n        uploaderFilesIndex.initFileList();\n        $fileList.trigger('loadTableComplete');\n        $(\"#Waiting\").hide();\n    },\n\n    /**\n     * Ajax List 取得用のURLを取得する\n     */\n    getListUrl() {\n        let listId = uploaderFilesIndex.listId;\n        let listUrl = $(\"#ListUrl\" + listId).attr('href');\n        let query = [];\n        let $filterUploaderCategoryId = $('#FilterUploaderCategoryId' + listId);\n        if ($filterUploaderCategoryId.length) {\n            query.push('uploader_category_id=' + $filterUploaderCategoryId.val());\n        } else {\n            query.push('uploader_category_id=');\n        }\n        let $checkedUploaderType = $('input[name=\"uploader_type\"]:checked');\n        if ($checkedUploaderType.length) {\n            query.push('uploader_type=' + $checkedUploaderType.val());\n        } else {\n            query.push('uploader_type=all');\n        }\n        let $filterName = $('#FilterName' + listId);\n        if ($filterName.val()) {\n            query.push('name=' + encodeURI($filterName.val()));\n        } else {\n            query.push('name=');\n        }\n        const num = location.search.match('limit=([0-9]+)');\n        if (num) {\n            query.push('limit=' + num[1]);\n        }\n        if (query.length) {\n            listUrl += '?' + query.join('&');\n        }\n        return listUrl;\n    },\n\n    /**\n     * コンテキストメニューハンドラ\n     */\n    contextMenuHandler(action, el) {\n        let listId = uploaderFilesIndex.listId;\n        let id = $(\"#FileList\" + listId + \" .selected .id\").html().trim();\n        let delUrl = $.bcUtil.apiAdminBaseUrl + 'bc-uploader/uploader_files/delete/' + id + '.json';\n        let fileName = $(\"#selectedFile\" + id +' .name').text().trim();\n        // IEの場合、action値が正常に取得できないので整形する\n        let pos = action.indexOf(\"#\");\n        if (pos !== -1) action = action.substring(pos + 1, action.length);\n\n        switch (action) {\n            case 'edit':\n                $('#EditDialog').dialog('open');\n                break;\n\n            case 'delete':\n                if (confirm(fileName + bcI18n.uploaderConfirmMessage1)) {\n                    $.bcToken.check(function () {\n                        $.ajax({\n                            url: delUrl,\n                            headers: {\n                                \"X-CSRF-Token\": $.bcToken.key,\n                            },\n                            type: 'post',\n                            dataType: 'json',\n                            beforeSend: function () {\n                                $(\"#Waiting\").show();\n                            },\n                            success: function () {\n                                $(\"#FileList\" + listId).trigger(\"deletecomplete\");\n                                uploaderFilesIndex.updateFileList();\n                            },\n                            error: function () {\n                                alert(bcI18n.uploaderAlertMessage4);\n                            },\n                            complete: function () {\n                                $(\"#Waiting\").hide();\n                                $.bcToken.key = null;\n                            }\n                        });\n                    }, {useUpdate: false, hideLoader: false});\n                }\n                break;\n        }\n    }\n\n}\n\nuploaderFilesIndex.mounted();\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"],"names":["uploaderFilesIndex","listId","allFields","categoryId","mounted","$listId","$","this","html","remove","add","initView","registerEvents","updateFileList","initDialog","click","dialog","bgiframe","autoOpen","position","at","of","window","width","modal","open","name","show","val","trim","publishBeginDate","publishBeginTime","publishBeginDateTime","publishEndDate","publishEndTime","publishEndDateTime","$uploaderCategoryId","length","ajax","url","bcUtil","adminBaseUrl","type","dataType","success","res","hide","after","buttons","cancel","text","bcI18n","uploaderCancel","save","uploaderSave","saveButton","id","bcToken","check","data","key","apiAdminBaseUrl","removeClass","error","response","fields","uploaderFile","publish_begin","uploaderPublishBegin","publish_end","uploaderPublishEnd","message","responseJSON","undefined","errors","Object","keys","forEach","field","alert","hideLoader","useUpdate","close","uploaderFileFileChangeHandler","$file","showLoader","fd","FormData","append","prop","processData","contentType","cache","beforeSend","hideMessage","uploadSuccessHandler","showApiError","showAlertMessage","prepend","uploaderAlertMessage2","change","getListUrl","updateFileListCompleteHandler","isFileEditDisabled","fileUserId","loginUserId","loginUserGroupId","usePermission","Number","disabled","parseInt","initFileList","$selectableFile","unbind","unpublishBackGroundColor","$divPanelList","fn","contextMenu","selector","callback","contextMenuHandler","build","$trigger","e","find","items","edit","uploaderEdit","icon","opt","delete","uploaderDelete","$selectableFileInPanelList","each","bind","uploaderAlertMessage3","hasClass","css","addClass","get","attr","on","$fileList","trigger","effect","result","listUrl","query","$filterUploaderCategoryId","push","$checkedUploaderType","$filterName","encodeURI","num","location","search","match","join","action","el","delUrl","fileName","pos","indexOf","substring","confirm","uploaderConfirmMessage1","headers","uploaderAlertMessage4","complete"],"sourceRoot":""}